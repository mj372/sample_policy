{
  "comments": "Dynamic Layer Demo",
  "tags": [],
  "dry-run": false,
  "referenced-objects": {
    "access-layers": [
      "my_dynamic_layer"
    ],
    "services-icmp": [
      "echo-request"
    ]
  },
  "objects": {
    "hosts": [
      {
        "name": "google_dns",
        "ip-address": "8.8.8.8"
      },
      {
        "name": "domain_controller",
        "ip-address": "172.24.1.1"
      }
    ],
    "networks": [
      {
        "name": "client_net",
        "subnet": "192.168.101.0",
        "mask-length": 24
      },
      {
        "name": "mynetwork",
        "subnet": "10.10.10.0",
        "mask-length": 24
      }
    ]
  },
  "access-layers-content": [
    {
      "name": "my_dynamic_layer",
      "operation": "replace",
      "rulebase": [
        {
          "name": "client_to_google_dns",
          "action": "accept",
          "source": [
            "client_net"
          ],
          "destination": [
            "google_dns"
          ],
          "service": [
            "echo-request"
          ],
          "track": {
            "type": "Log"
          }
        },
        {
          "name": "access_to_dc",
          "action": "drop",
          "source": [
            "client_net"
          ],
          "destination": [
            "domain_controller"
          ],
          "service": [
            "echo-request"
          ],
          "track": {
            "type": "Log"
          }
        },
        {
          "name": "test",
          "action": "drop",
          "source": [
            "mynetwork"
          ],
          "destination": [
            "domain_controller"
          ],
          "service": [
            "echo-request"
          ],
          "track": {
            "type": "Log"
          }
        },
        {
          "name": "ping_to_dc",
          "action": "drop",
          "source": "any",
          "destination": [
            "domain_controller"
          ],
          "service": [
            "echo-request"
          ],
          "track": {
            "type": "Log"
          }
        },
        {
          "name": "drop_all",
          "action": "accept",
          "source": "any",
          "destination": "any",
          "service": "any",
          "track": {
            "type": "None"
          }
        }
      ]
    }
  ]
}